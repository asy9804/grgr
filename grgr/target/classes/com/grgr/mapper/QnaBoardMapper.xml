<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.grgr.mapper.QnaBoardMapper">
	<!-- 게시글 삽입 -->
	<insert id="insertQnaBoard">
		<selectKey resultType="int" keyProperty="qna_bno" order="BEFORE">
			select qna_bno_seq.nextval 
			from dual 
		</selectKey>
		insert into qna_board values(#{qna_bno}, #{qna_uno}, #{qna_keyword}, #{qna_title}
			, #{qna_content}, #{qna_blindstate}, sysdate, sysdate, #{qna_update_uno})
	</insert>	
	
	<!-- 게시글 수정 -->
	<update id="updateQnaBoard">
		update qna_board set qna_uno=#{qna_uno}, qna_keyword=#{qna_keyword}
			, qna_title=#{qna_title}, qna_content=#{qna_content}
				, qna_blindstate=#{qna_blindstate}, qna_update_uno=#{qna_update_uno}
		where uno=#{uno}
	</update>
	
	<!-- 게시글 삭제 -->
	<delete id="deleteQnaBoard">
		delete 
		from qna_board=3 
		where qna_bno=#{qna_bno}
	</delete>
	
	<!-- 게시글 검색 -->
	<select id="selectQnaBoard" resultType="QnaBoard">
		select qna_blindstate, qna_title, qna_content from qna_board 
		where qna_blindatate like qna_blindstate=1 
			and qna_title like '%||'#{qna_title}||'%' 
				or qna_content like '%'||#{qna_content}||'%' 
	</select>
	
	<!-- 게시글 개수 검색? -->
	<select id="selectQnaBoardCount" resultType="int">
		select count(*) 
		from qna_board
	</select>
	
	<!-- 게시글 리스트 검색? -->
	<select id="selectQnaBoardList" resultType="QnaBoard">
		select * 
		from (select rownum rn, board.* 
			from(select qna_title, qna_content, qna_blindstate, qna_regdate	
				, qna_modifydate, qna_update_uno 
				from qna_board 
				where qna_blindatate like qna_blindstate=1 
					and qna_title like '%||'#{qna_title}||'%'
						or qna_content like '%'||#{qna_content}||'%' 
				order by qna_bno) 
					board) 
		 where rn between #{startRow} and #{endRow}
	</select>
</mapper>
